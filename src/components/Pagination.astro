---
import type { Language } from '@/types';
import { t } from '@/lib/utils';

interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
  lang: Language;
}

const { currentPage, totalPages, baseUrl, lang } = Astro.props;

const prevPage = currentPage > 1 ? currentPage - 1 : null;
const nextPage = currentPage < totalPages ? currentPage + 1 : null;

function getPageUrl(page: number): string {
  if (page === 1) return baseUrl;
  return `${baseUrl}/page/${page}`;
}

// Generate page numbers to show (max 7 pages)
const pages: (number | string)[] = [];
if (totalPages <= 7) {
  for (let i = 1; i <= totalPages; i++) {
    pages.push(i);
  }
} else {
  if (currentPage <= 3) {
    pages.push(1, 2, 3, 4, '...', totalPages);
  } else if (currentPage >= totalPages - 2) {
    pages.push(1, '...', totalPages - 3, totalPages - 2, totalPages - 1, totalPages);
  } else {
    pages.push(1, '...', currentPage - 1, currentPage, currentPage + 1, '...', totalPages);
  }
}
---

{totalPages > 1 && (
  <nav aria-label="Pagination" class="flex items-center justify-center space-x-2 mt-12">
    {/* Previous button */}
    {prevPage ? (
      <a
        href={getPageUrl(prevPage)}
        rel="prev"
        class="inline-flex items-center px-4 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-lg hover:bg-neutral-50 transition-colors"
      >
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        {t(lang, 'previous')}
      </a>
    ) : (
      <span class="inline-flex items-center px-4 py-2 text-sm font-medium text-neutral-400 bg-white border border-neutral-200 rounded-lg cursor-not-allowed">
        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        {t(lang, 'previous')}
      </span>
    )}

    {/* Page numbers */}
    <div class="hidden sm:flex items-center space-x-1">
      {pages.map((page) =>
        typeof page === 'number' ? (
          <a
            href={getPageUrl(page)}
            class={`inline-flex items-center justify-center w-10 h-10 text-sm font-medium rounded-lg transition-colors ${
              page === currentPage
                ? 'bg-primary-600 text-white'
                : 'text-neutral-700 bg-white border border-neutral-300 hover:bg-neutral-50'
            }`}
            aria-current={page === currentPage ? 'page' : undefined}
          >
            {page}
          </a>
        ) : (
          <span class="inline-flex items-center justify-center w-10 h-10 text-neutral-500">
            {page}
          </span>
        )
      )}
    </div>

    {/* Current page indicator (mobile) */}
    <div class="sm:hidden inline-flex items-center px-4 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-lg">
      {t(lang, 'page')} {currentPage} / {totalPages}
    </div>

    {/* Next button */}
    {nextPage ? (
      <a
        href={getPageUrl(nextPage)}
        rel="next"
        class="inline-flex items-center px-4 py-2 text-sm font-medium text-neutral-700 bg-white border border-neutral-300 rounded-lg hover:bg-neutral-50 transition-colors"
      >
        {t(lang, 'next')}
        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </a>
    ) : (
      <span class="inline-flex items-center px-4 py-2 text-sm font-medium text-neutral-400 bg-white border border-neutral-200 rounded-lg cursor-not-allowed">
        {t(lang, 'next')}
        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </span>
    )}
  </nav>
)}
