---
import type { SEOProps } from '@/types';

interface Props extends SEOProps {}

const {
  title,
  description,
  canonical,
  image,
  noIndex = false,
  type = 'website',
  publishedTime,
  modifiedTime,
  author,
  tags,
  lang,
  alternates = [],
  twitterHandle,
} = Astro.props;

const siteName = import.meta.env.PUBLIC_SITE_NAME || 'Sarlab Blog';
const siteUrl = import.meta.env.PUBLIC_SITE_URL || 'https://sarlab.pro';
const defaultImage = `${siteUrl}/og-default.jpg`;

const fullTitle = title.includes(siteName) ? title : `${title} | ${siteName}`;
const ogImage = image || defaultImage;
const canonicalUrl = canonical || Astro.url.href;
---

<!-- Primary Meta Tags -->
<title>{fullTitle}</title>
<meta name="title" content={fullTitle} />
<meta name="description" content={description} />
<link rel="canonical" href={canonicalUrl} />
<meta name="language" content={lang} />

{noIndex && <meta name="robots" content="noindex, nofollow" />}
{!noIndex && <meta name="robots" content="index, follow" />}

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={canonicalUrl} />
<meta property="og:title" content={fullTitle} />
<meta property="og:description" content={description} />
<meta property="og:image" content={ogImage} />
<meta property="og:site_name" content={siteName} />
<meta property="og:locale" content={lang === 'tr' ? 'tr_TR' : lang === 'de' ? 'de_DE' : 'en_US'} />

{publishedTime && <meta property="article:published_time" content={publishedTime} />}
{modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}
{author && <meta property="article:author" content={author} />}
{tags && tags.map(tag => <meta property="article:tag" content={tag} />)}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:url" content={canonicalUrl} />
<meta name="twitter:title" content={fullTitle} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={ogImage} />
{twitterHandle && <meta name="twitter:site" content={twitterHandle} />}
{twitterHandle && <meta name="twitter:creator" content={twitterHandle} />}

<!-- Alternate Languages -->
{alternates.map(alt => (
  <link rel="alternate" hreflang={alt.lang} href={alt.href} />
))}
<link rel="alternate" hreflang="x-default" href={alternates.find(a => a.lang === 'en')?.href || siteUrl} />
